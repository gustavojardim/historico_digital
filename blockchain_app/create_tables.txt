-- public.users definition

-- Drop table

-- DROP TABLE public.users;

CREATE TABLE public.users (
	user_id int4 NOT NULL GENERATED ALWAYS AS IDENTITY,
	cpf varchar(11) NOT NULL,
	"name" varchar(128) NOT NULL,
	email varchar(64) NOT NULL,
	"password" varchar(12) NOT NULL,
	CONSTRAINT cpf_un UNIQUE (cpf),
	CONSTRAINT email_un UNIQUE (email),
	CONSTRAINT users_pk PRIMARY KEY (user_id)
);


-- public.vendor definition

-- Drop table

-- DROP TABLE public.vendor;

CREATE TABLE public.vendor (
	vendor_id int4 NOT NULL GENERATED ALWAYS AS IDENTITY,
	cnpj varchar(14) NOT NULL,
	"name" varchar(128) NOT NULL,
	email varchar(64) NOT NULL,
	"password" varchar(12) NOT NULL,
	CONSTRAINT cnpj_un UNIQUE (cnpj),
	CONSTRAINT vendor_pk PRIMARY KEY (vendor_id)
);


-- public.car definition

-- Drop table

-- DROP TABLE public.car;

CREATE TABLE public.car (
	car_id int4 NOT NULL GENERATED ALWAYS AS IDENTITY,
	user_id int4 NOT NULL,
	license_plate varchar(7) NOT NULL,
	current_mileage_in_km varchar(7) NOT NULL,
	CONSTRAINT car_pk PRIMARY KEY (car_id),
	CONSTRAINT license_plate_un UNIQUE (license_plate),
	CONSTRAINT user_fk FOREIGN KEY (user_id) REFERENCES users(user_id)
);


-- public.service definition

-- Drop table

-- DROP TABLE public.service;

CREATE TABLE public.service (
	service_id int4 NOT NULL GENERATED ALWAYS AS IDENTITY,
	block_hash varchar(128) NOT NULL,
	block_number int4 NOT NULL,
	car_id int4 NOT NULL,
	user_id int4 NOT NULL,
	vendor_id int4 NOT NULL,
	CONSTRAINT service_pk PRIMARY KEY (service_id),
	CONSTRAINT car_fk FOREIGN KEY (car_id) REFERENCES car(car_id),
	CONSTRAINT users_fk FOREIGN KEY (user_id) REFERENCES users(user_id),
	CONSTRAINT vendor_fk FOREIGN KEY (vendor_id) REFERENCES vendor(vendor_id)
);
